<Window x:Class="YouTubeDownloader.VideoPreviewDialog"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Select Quality" 
        Height="620" 
        Width="400"
        WindowStartupLocation="CenterOwner"
        ResizeMode="NoResize"
        WindowStyle="None"
        AllowsTransparency="True"
        Background="Transparent">
    
    <Window.Resources>
        <LinearGradientBrush x:Key="BlueGradient" StartPoint="0,0" EndPoint="1,1">
            <GradientStop Color="#007AFF" Offset="0"/>
            <GradientStop Color="#0051D5" Offset="1"/>
        </LinearGradientBrush>
        
        <!-- iOS-style Segmented Control Button -->
        <Style x:Key="SegmentedButton" TargetType="RadioButton">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="RadioButton">
                        <Border x:Name="border"
                                Background="#E8E8ED"
                                CornerRadius="8"
                                Padding="0,12"
                                Margin="3"
                                Cursor="Hand">
                            <TextBlock Text="{TemplateBinding Content}"
                                      x:Name="text"
                                      FontSize="17"
                                      FontWeight="Normal"
                                      Foreground="Black"
                                      HorizontalAlignment="Center"
                                      VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsChecked" Value="True">
                                <Setter TargetName="border" Property="Background" Value="White"/>
                                <Setter TargetName="border" Property="Effect">
                                    <Setter.Value>
                                        <DropShadowEffect BlurRadius="8" ShadowDepth="0" Opacity="0.15" Color="Black"/>
                                    </Setter.Value>
                                </Setter>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        
        <!-- Resolution List Item -->
        <Style x:Key="ResolutionItem" TargetType="RadioButton">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="RadioButton">
                        <Border x:Name="border"
                                Background="White"
                                BorderBrush="#E5E5EA"
                                BorderThickness="0,0,0,1"
                                Padding="16,14"
                                Cursor="Hand">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                
                                <TextBlock x:Name="resolution" 
                                          Grid.Column="0"
                                          FontSize="16" 
                                          FontWeight="Normal"
                                          Foreground="Black"
                                          VerticalAlignment="Center"/>
                                
                                <!-- Right Chevron -->
                                <TextBlock Grid.Column="1"
                                          Text="›" 
                                          FontSize="18" 
                                          Foreground="#C7C7CC"
                                          VerticalAlignment="Center"/>
                                
                                <!-- Hidden elements for compatibility -->
                                <TextBlock x:Name="filesize" Visibility="Collapsed"/>
                                <Border x:Name="badgeBorder" Visibility="Collapsed">
                                    <TextBlock x:Name="badge"/>
                                </Border>
                            </Grid>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsChecked" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#E3F2FD"/>
                                <Setter TargetName="resolution" Property="Foreground" Value="#007AFF"/>
                                <Setter TargetName="resolution" Property="FontWeight" Value="SemiBold"/>
                            </Trigger>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#F5F5F5"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>
    
    <!-- Light gray blurred background -->
    <Border Background="#F0EFEFF4" CornerRadius="20">
        <Border.Effect>
            <DropShadowEffect BlurRadius="30" ShadowDepth="0" Opacity="0.2" Color="Black"/>
        </Border.Effect>
        
        <Grid Margin="0,20,0,20">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/> <!-- Thumbnail -->
                <RowDefinition Height="Auto"/> <!-- Chevron -->
                <RowDefinition Height="Auto"/> <!-- Segmented Control -->
                <RowDefinition Height="Auto"/> <!-- Divider -->
                <RowDefinition Height="Auto"/> <!-- Header row -->
                <RowDefinition Height="Auto"/> <!-- Resolution list -->
                <RowDefinition Height="*"/>    <!-- Spacer -->
            </Grid.RowDefinitions>
            
            <!-- Small horizontal video thumbnail (16:9) -->
            <Border Grid.Row="0" 
                    Height="90" 
                    Width="160"
                    CornerRadius="8"
                    Background="#E5E5EA"
                    ClipToBounds="True"
                    HorizontalAlignment="Center"
                    Margin="0,10,0,10">
                <Border.Effect>
                    <DropShadowEffect BlurRadius="6" ShadowDepth="2" Opacity="0.12" Color="Black"/>
                </Border.Effect>
                <Image x:Name="ThumbnailImage" 
                       Stretch="UniformToFill"/>
            </Border>
            
            <!-- Small downward chevron arrow icon -->
            <TextBlock Grid.Row="1" 
                      Text="›" 
                      FontSize="16" 
                      Foreground="#8E8E93"
                      HorizontalAlignment="Center"
                      Margin="0,0,0,15">
                <TextBlock.RenderTransform>
                    <RotateTransform Angle="90" CenterX="8" CenterY="8"/>
                </TextBlock.RenderTransform>
            </TextBlock>
            
            <!-- Segmented control tabs -->
            <Grid Grid.Row="2" Margin="20,0,20,15">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                <RadioButton x:Name="VideoTab"
                            Grid.Column="0"
                            Content="Video"
                            Style="{StaticResource SegmentedButton}"
                            GroupName="MediaType"
                            IsChecked="True"
                            Checked="VideoTab_Checked"/>
                <RadioButton x:Name="AudioTab"
                            Grid.Column="1"
                            Content="Audio"
                            Style="{StaticResource SegmentedButton}"
                            GroupName="MediaType"
                            Checked="AudioTab_Checked"/>
            </Grid>
            
            <!-- Horizontal line divider -->
            <Border Grid.Row="3" 
                    Height="1" 
                    Background="#E5E5EA"
                    Margin="20,0"/>
            
            <!-- Main section: Select video resolution | Download icon | Download -->
            <Grid Grid.Row="4" Margin="20,15,20,12">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <!-- Left: "Select video resolution" -->
                <TextBlock Grid.Column="0"
                          Text="Select video resolution"
                          FontSize="17"
                          FontWeight="Normal"
                          Foreground="Black"
                          VerticalAlignment="Center"/>
                
                <!-- Download Icon -->
                <TextBlock Grid.Column="2"
                          Text="⬇" 
                          FontSize="16" 
                          Foreground="#007AFF"
                          VerticalAlignment="Center"
                          Margin="0,0,5,0"/>
                
                <!-- Right: Blue "Download" text -->
                <TextBlock Grid.Column="3"
                          x:Name="DownloadText"
                          Text="Download"
                          FontSize="17"
                          FontWeight="Normal"
                          Foreground="#007AFF"
                          VerticalAlignment="Center"
                          Cursor="Hand"
                          MouseDown="DownloadButton_Click"/>
            </Grid>
            
            <!-- Expanded dropdown list in white card with light border -->
            <Border Grid.Row="5" 
                    Background="White"
                    BorderBrush="#E5E5EA"
                    BorderThickness="1"
                    CornerRadius="10"
                    Margin="20,0,20,15">
                <Border.Effect>
                    <DropShadowEffect BlurRadius="8" ShadowDepth="2" Opacity="0.08" Color="Black"/>
                </Border.Effect>
                <StackPanel x:Name="QualityPanel">
                    <!-- Resolution rows will be added here -->
                </StackPanel>
            </Border>
            
            <!-- Hidden title for compatibility -->
            <TextBlock x:Name="TitleText" Visibility="Collapsed"/>
        </Grid>
    </Border>
</Window>
