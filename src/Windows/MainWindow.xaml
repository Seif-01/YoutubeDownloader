<Window x:Class="YouTubeDownloader.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="YouTube Downloader" 
        Height="720" 
        Width="405"
        ResizeMode="NoResize"
        WindowStyle="None"
        AllowsTransparency="True"
        Background="Transparent">
    
    <Border CornerRadius="40" Background="{DynamicResource BackgroundBrush}">
        <Border.Effect>
            <DropShadowEffect BlurRadius="40" ShadowDepth="0" Opacity="0.5"/>
        </Border.Effect>
        
        <Grid>
            <!-- Background Image -->
            <Border CornerRadius="40" ClipToBounds="True">
                <Grid>
                    <Image x:Name="BackgroundImage" 
                           Source="Assets/sakura.jpg" 
                           Stretch="UniformToFill"/>
                    
                    <!-- Very light overlay - pink and white tint -->
                    <Border>
                        <Border.Background>
                            <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                                <GradientStop Color="#19FFB6C1" Offset="0"/>
                                <GradientStop Color="#0CFFFFFF" Offset="0.5"/>
                                <GradientStop Color="#1987CEEB" Offset="1"/>
                            </LinearGradientBrush>
                        </Border.Background>
                    </Border>
                    
                    <!-- Animated petals canvas -->
                    <Canvas x:Name="PetalsCanvas" />
                </Grid>
            </Border>
            
            <!-- Main Content -->
            <Grid x:Name="MainContent" Margin="20">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                
                <!-- Header with Time -->
                <StackPanel Grid.Row="0" HorizontalAlignment="Center" Margin="0,20,0,30">
                    <TextBlock x:Name="TimeDisplay" 
                               Text="23:55" 
                               FontSize="72" 
                               FontWeight="Light" 
                               Foreground="White"
                               HorizontalAlignment="Center">
                        <TextBlock.Effect>
                            <DropShadowEffect BlurRadius="10" ShadowDepth="2" Opacity="0.5"/>
                        </TextBlock.Effect>
                    </TextBlock>
                    <TextBlock x:Name="DateDisplay" 
                               Text="June 26, Wednesday" 
                               FontSize="16" 
                               Foreground="White" 
                               Opacity="0.95"
                               HorizontalAlignment="Center">
                        <TextBlock.Effect>
                            <DropShadowEffect BlurRadius="10" ShadowDepth="2" Opacity="0.5"/>
                        </TextBlock.Effect>
                    </TextBlock>
                </StackPanel>
                
                <!-- Search Box -->
                <Border Grid.Row="1" 
                        Background="{DynamicResource SearchBoxBrush}" 
                        CornerRadius="25" 
                        Padding="15,12"
                        Margin="0,0,0,20">
                    <Border.Effect>
                        <DropShadowEffect BlurRadius="20" ShadowDepth="4" Opacity="0.2"/>
                    </Border.Effect>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <TextBlock Text="ðŸ”" 
                                   FontSize="20" 
                                   Margin="5,0,10,0"
                                   VerticalAlignment="Center"
                                   Opacity="0.7"/>
                        <TextBox x:Name="UrlTextBox" 
                                 Grid.Column="1"
                                 BorderThickness="0"
                                 Background="Transparent"
                                 VerticalAlignment="Center"
                                 FontSize="14"
                                 Text="Paste YouTube Link here...">
                            <TextBox.Style>
                                <Style TargetType="TextBox">
                                    <Setter Property="Foreground" Value="#64748b"/>
                                    <EventSetter Event="GotFocus" Handler="UrlTextBox_GotFocus"/>
                                    <EventSetter Event="LostFocus" Handler="UrlTextBox_LostFocus"/>
                                </Style>
                            </TextBox.Style>
                        </TextBox>
                    </Grid>
                </Border>
                
                <!-- Download Card -->
                <Border Grid.Row="2" 
                        Background="{DynamicResource CardBgBrush}" 
                        CornerRadius="25" 
                        Padding="20"
                        Height="70">
                    <Border.Effect>
                        <DropShadowEffect BlurRadius="30" ShadowDepth="8" Opacity="0.15"/>
                    </Border.Effect>
                    <!-- Download Button - iOS Style -->
                    <Button Click="DownloadButton_Click"
                            HorizontalAlignment="Stretch"
                            VerticalAlignment="Center"
                            Height="50"
                            Cursor="Hand"
                            BorderThickness="0">
                        <Button.Template>
                            <ControlTemplate TargetType="Button">
                                <Border x:Name="border"
                                        CornerRadius="25"
                                        Background="#6B4FC3">
                                    <TextBlock Text="â¬‡ï¸ Download Video"
                                              Foreground="White"
                                              FontSize="17"
                                              FontWeight="SemiBold"
                                              HorizontalAlignment="Center"
                                              VerticalAlignment="Center"/>
                                </Border>
                                <ControlTemplate.Triggers>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter TargetName="border" Property="Background" Value="#5838A8"/>
                                    </Trigger>
                                    <Trigger Property="IsPressed" Value="True">
                                        <Setter TargetName="border" Property="Background" Value="#4A2C8D"/>
                                    </Trigger>
                                </ControlTemplate.Triggers>
                            </ControlTemplate>
                        </Button.Template>
                    </Button>
                </Border>
                
                <!-- Floating Action Buttons -->
                <StackPanel Grid.Row="3" 
                            VerticalAlignment="Bottom" 
                            HorizontalAlignment="Right"
                            Margin="0,0,10,10">
                    <!-- Downloads Button -->
                    <Button Width="60" 
                            Height="60" 
                            Margin="0,0,0,15"
                            Click="ShowDownloads_Click"
                            ToolTip="View Downloads">
                        <Button.Template>
                            <ControlTemplate TargetType="Button">
                                <Border Background="#CC007AFF" 
                                        CornerRadius="15"
                                        x:Name="border">
                                    <Border.Effect>
                                        <DropShadowEffect BlurRadius="20" ShadowDepth="6" Opacity="0.4"/>
                                    </Border.Effect>
                                    <!-- Download Icon SVG-style -->
                                    <Grid>
                                        <Viewbox Width="32" Height="32">
                                            <Canvas Width="24" Height="24">
                                                <!-- Download arrow -->
                                                <Path Data="M12 3 L12 15 M12 15 L8 11 M12 15 L16 11" 
                                                      Stroke="White" 
                                                      StrokeThickness="2" 
                                                      StrokeEndLineCap="Round"
                                                      StrokeStartLineCap="Round"
                                                      StrokeLineJoin="Round"/>
                                                <!-- Bottom tray -->
                                                <Path Data="M4 17 L4 19 C4 20.1 4.9 21 6 21 L18 21 C19.1 21 20 20.1 20 19 L20 17" 
                                                      Stroke="White" 
                                                      StrokeThickness="2" 
                                                      StrokeEndLineCap="Round"
                                                      StrokeStartLineCap="Round"
                                                      StrokeLineJoin="Round"/>
                                            </Canvas>
                                        </Viewbox>
                                    </Grid>
                                </Border>
                                <ControlTemplate.Triggers>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter TargetName="border" Property="Background" Value="#E6007AFF"/>
                                        <Setter TargetName="border" Property="RenderTransform">
                                            <Setter.Value>
                                                <ScaleTransform ScaleX="1.1" ScaleY="1.1" CenterX="30" CenterY="30"/>
                                            </Setter.Value>
                                        </Setter>
                                    </Trigger>
                                </ControlTemplate.Triggers>
                            </ControlTemplate>
                        </Button.Template>
                    </Button>
                    
                    <!-- Folder Button -->
                    <Button Width="60" 
                            Height="60" 
                            Click="OpenFolder_Click"
                            ToolTip="Open Downloads Folder">
                        <Button.Template>
                            <ControlTemplate TargetType="Button">
                                <Border Background="#CC007AFF" 
                                        CornerRadius="15"
                                        x:Name="border">
                                    <Border.Effect>
                                        <DropShadowEffect BlurRadius="20" ShadowDepth="6" Opacity="0.4"/>
                                    </Border.Effect>
                                    <!-- Folder Icon SVG-style -->
                                    <Grid>
                                        <Viewbox Width="32" Height="32">
                                            <Canvas Width="24" Height="24">
                                                <!-- Folder shape -->
                                                <Path Data="M3 6 C3 4.9 3.9 4 5 4 L9 4 L11 6 L19 6 C20.1 6 21 6.9 21 8 L21 18 C21 19.1 20.1 20 19 20 L5 20 C3.9 20 3 19.1 3 18 L3 6 Z" 
                                                      Fill="White"/>
                                            </Canvas>
                                        </Viewbox>
                                    </Grid>
                                </Border>
                                <ControlTemplate.Triggers>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter TargetName="border" Property="Background" Value="#E6007AFF"/>
                                        <Setter TargetName="border" Property="RenderTransform">
                                            <Setter.Value>
                                                <ScaleTransform ScaleX="1.1" ScaleY="1.1" CenterX="30" CenterY="30"/>
                                            </Setter.Value>
                                        </Setter>
                                    </Trigger>
                                </ControlTemplate.Triggers>
                            </ControlTemplate>
                        </Button.Template>
                    </Button>
                </StackPanel>
            </Grid>
            
            <!-- Downloads Panel (Hidden by default) -->
            <Border x:Name="DownloadsPanel" 
                    Background="{DynamicResource PanelBgBrush}"
                    CornerRadius="40"
                    RenderTransform="1,0,0,1,405,0"
                    ClipToBounds="True">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    
                    <!-- Downloads Header -->
                    <Border Grid.Row="0" Background="{StaticResource BlueGradient}" Padding="20">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Button Content="â€¹" 
                                    FontSize="48" 
                                    FontWeight="Black"
                                    Foreground="White"
                                    Background="Transparent"
                                    BorderThickness="0"
                                    Click="HideDownloads_Click"
                                    Cursor="Hand"
                                    ToolTip="Back"
                                    Padding="0"
                                    Margin="-5,0,0,0"/>
                            <TextBlock Grid.Column="1" 
                                       Text="Downloads" 
                                       FontSize="24" 
                                       FontWeight="SemiBold"
                                       Foreground="White"
                                       VerticalAlignment="Center"
                                       Margin="15,0,0,0"/>
                        </Grid>
                    </Border>
                    
                    <!-- Tabs -->
                    <Border Grid.Row="1" 
                            Background="#CCFFFFFF" 
                            CornerRadius="15" 
                            Margin="15"
                            Padding="5">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Button x:Name="AllTab"
                                    Content="ðŸ“¥ All" 
                                    Background="{StaticResource BlueGradient}"
                                    Foreground="White"
                                    Style="{StaticResource ModernButton}"
                                    Click="AllTab_Click"/>
                            <Button x:Name="DownloadedTab"
                                    Grid.Column="1"
                                    Content="âœ“ Downloaded"
                                    Background="#80E2E8F0"
                                    Foreground="#475569"
                                    FontWeight="SemiBold"
                                    Style="{StaticResource ModernButton}"
                                    Click="DownloadedTab_Click"/>
                        </Grid>
                    </Border>
                    
                    <!-- Downloads List -->
                    <ScrollViewer Grid.Row="2" 
                                  VerticalScrollBarVisibility="Auto"
                                  Margin="15,0,15,0">
                        <StackPanel x:Name="DownloadsList">
                            <!-- Download items will be added here dynamically -->
                        </StackPanel>
                    </ScrollViewer>
                    
                    <!-- Bottom Actions -->
                    <Border Grid.Row="3" 
                            Background="#CCFFFFFF" 
                            BorderBrush="#80E2E8F0"
                            BorderThickness="0,1,0,0"
                            Padding="15">
                        <Button Content="ðŸ—‘ï¸ Clear List"
                                Background="Transparent"
                                Foreground="#3B82F6"
                                BorderBrush="#3B82F6"
                                BorderThickness="2"
                                Style="{StaticResource ModernButton}"
                                HorizontalAlignment="Stretch"
                                Click="ClearList_Click"/>
                    </Border>
                </Grid>
            </Border>
            
            <!-- Dark Mode Toggle (iOS Style) -->
            <Border HorizontalAlignment="Left"
                    VerticalAlignment="Top"
                    Margin="15,15,0,0"
                    Background="#66FFFFFF"
                    CornerRadius="20"
                    Padding="3"
                    Width="60"
                    Height="32">
                <Grid>
                    <Border x:Name="DarkModeToggleBackground"
                            Background="White"
                            CornerRadius="17">
                        <Border.Effect>
                            <DropShadowEffect BlurRadius="8" ShadowDepth="2" Opacity="0.2"/>
                        </Border.Effect>
                    </Border>
                    <Border x:Name="DarkModeToggleThumb"
                            Width="26"
                            Height="26"
                            CornerRadius="13"
                            Background="#FFD700"
                            HorizontalAlignment="Left"
                            Margin="3,0,0,0">
                        <Border.Effect>
                            <DropShadowEffect BlurRadius="4" ShadowDepth="1" Opacity="0.3"/>
                        </Border.Effect>
                        <TextBlock x:Name="DarkModeIcon"
                                   Text="â˜€"
                                   FontSize="16"
                                   HorizontalAlignment="Center"
                                   VerticalAlignment="Center"
                                   Foreground="White"/>
                    </Border>
                    <Border Background="Transparent"
                            Cursor="Hand"
                            MouseDown="DarkModeToggle_Click"/>
                </Grid>
            </Border>
            
            <!-- Window Controls -->
            <StackPanel Orientation="Horizontal" 
                        HorizontalAlignment="Right" 
                        VerticalAlignment="Top"
                        Margin="0,10,10,0">
                <Button Content="âˆ’" 
                        Width="30" 
                        Height="30"
                        FontSize="20"
                        Foreground="White"
                        Background="#66000000"
                        BorderThickness="0"
                        Click="Minimize_Click"
                        Cursor="Hand"
                        ToolTip="Minimize">
                    <Button.Template>
                        <ControlTemplate TargetType="Button">
                            <Border Background="{TemplateBinding Background}" 
                                    CornerRadius="15"
                                    x:Name="border">
                                <ContentPresenter HorizontalAlignment="Center" 
                                                VerticalAlignment="Center"/>
                            </Border>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter TargetName="border" Property="Background" Value="#99000000"/>
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Button.Template>
                </Button>
                <Button Content="Ã—" 
                        Width="30" 
                        Height="30"
                        FontSize="20"
                        Foreground="White"
                        Background="#66EF4444"
                        BorderThickness="0"
                        Margin="5,0,0,0"
                        Click="Close_Click"
                        Cursor="Hand"
                        ToolTip="Close">
                    <Button.Template>
                        <ControlTemplate TargetType="Button">
                            <Border Background="{TemplateBinding Background}" 
                                    CornerRadius="15"
                                    x:Name="border">
                                <ContentPresenter HorizontalAlignment="Center" 
                                                VerticalAlignment="Center"/>
                            </Border>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter TargetName="border" Property="Background" Value="#CCEF4444"/>
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Button.Template>
                </Button>
            </StackPanel>
            
            <!-- Quality Selection Overlay (iOS Bottom Sheet Style) -->
            <Border x:Name="QualityOverlay"
                    Background="#CC000000"
                    Visibility="Collapsed"
                    MouseDown="QualityOverlay_MouseDown">
                <Grid>
                    <Border VerticalAlignment="Bottom"
                            Background="White"
                            CornerRadius="20,20,0,0"
                            MaxHeight="500"
                            Margin="0,0,0,0">
                        <Grid Margin="20">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            
                            <!-- Header -->
                            <Grid Grid.Row="0" Margin="0,10,0,20">
                                <TextBlock Text="Select Quality"
                                          FontSize="20"
                                          FontWeight="Bold"
                                          Foreground="#1A1A2E"
                                          HorizontalAlignment="Center"/>
                                <Button Content="âœ•"
                                       HorizontalAlignment="Right"
                                       Width="30"
                                       Height="30"
                                       FontSize="18"
                                       Background="Transparent"
                                       BorderThickness="0"
                                       Foreground="#666"
                                       Cursor="Hand"
                                       Click="CloseQualitySelector_Click"/>
                            </Grid>
                            
                            <!-- Video Info -->
                            <StackPanel Grid.Row="1" Margin="0,0,0,15">
                                <!-- Thumbnail -->
                                <Border Height="140" 
                                        CornerRadius="12" 
                                        Margin="0,0,0,15"
                                        Background="#E2E8F0">
                                    <Image x:Name="QualityThumbnail" 
                                           Stretch="UniformToFill"/>
                                </Border>
                                
                                <TextBlock x:Name="QualityVideoTitle"
                                          Text="Video Title"
                                          FontSize="15"
                                          FontWeight="SemiBold"
                                          Foreground="#333"
                                          TextWrapping="Wrap"
                                          MaxHeight="60"
                                          TextTrimming="CharacterEllipsis"
                                          Margin="0,0,0,15"/>
                                
                                <!-- Video/Audio Type Tabs -->
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <Button x:Name="VideoFormatTab"
                                            Content="ðŸ“¹ Video"
                                            Background="{StaticResource BlueGradient}"
                                            Foreground="White"
                                            Style="{StaticResource ModernButton}"
                                            Click="VideoFormatTab_Click"
                                            Margin="0,0,5,0"/>
                                    <Button x:Name="AudioFormatTab"
                                            Grid.Column="1"
                                            Content="ðŸŽµ Audio"
                                            Background="#E2E8F0"
                                            Foreground="#475569"
                                            Style="{StaticResource ModernButton}"
                                            Click="AudioFormatTab_Click"
                                            Margin="5,0,0,0"/>
                                </Grid>
                            </StackPanel>
                            
                            <!-- Quality List -->
                            <ScrollViewer Grid.Row="2" 
                                        VerticalScrollBarVisibility="Auto"
                                        Margin="0,0,0,15">
                                <StackPanel x:Name="QualityListPanel"/>
                            </ScrollViewer>
                            
                            <!-- Download Button -->
                            <Button Grid.Row="3"
                                   x:Name="QualityDownloadButton"
                                   Click="QualityDownload_Click"
                                   Height="50"
                                   Cursor="Hand"
                                   BorderThickness="0">
                                <Button.Template>
                                    <ControlTemplate TargetType="Button">
                                        <Border x:Name="border"
                                                CornerRadius="25"
                                                Background="#007AFF">
                                            <TextBlock Text="Download"
                                                      Foreground="White"
                                                      FontSize="17"
                                                      FontWeight="SemiBold"
                                                      HorizontalAlignment="Center"
                                                      VerticalAlignment="Center"/>
                                        </Border>
                                        <ControlTemplate.Triggers>
                                            <Trigger Property="IsMouseOver" Value="True">
                                                <Setter TargetName="border" Property="Background" Value="#0051D5"/>
                                            </Trigger>
                                            <Trigger Property="IsPressed" Value="True">
                                                <Setter TargetName="border" Property="Background" Value="#003C8F"/>
                                            </Trigger>
                                        </ControlTemplate.Triggers>
                                    </ControlTemplate>
                                </Button.Template>
                            </Button>
                        </Grid>
                    </Border>
                </Grid>
            </Border>
        </Grid>
    </Border>
</Window>
