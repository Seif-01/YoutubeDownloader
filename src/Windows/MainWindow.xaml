<Window x:Class="YouTubeDownloader.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="YouTube Downloader" 
        Height="720" 
        Width="405"
        ResizeMode="NoResize"
        WindowStyle="None"
        AllowsTransparency="True"
        Background="Transparent">
    
    <Border CornerRadius="40" Background="{DynamicResource BackgroundBrush}">
        <Border.Effect>
            <DropShadowEffect BlurRadius="40" ShadowDepth="0" Opacity="0.5"/>
        </Border.Effect>
        
        <Grid>
            <!-- Background Image -->
            <Border CornerRadius="40" ClipToBounds="True">
                <Grid>
                    <Image x:Name="BackgroundImage" 
                           Source="Assets/sakura.jpg" 
                           Stretch="UniformToFill"/>
                    
                    <!-- Subtle overlay wash -->
                    <Border x:Name="BackgroundOverlay" Background="#26000000"/>
                    
                    <!-- Animated petals canvas -->
                    <Canvas x:Name="PetalsCanvas" />
                </Grid>
            </Border>
            
            <!-- Main Content -->
            <Grid x:Name="MainContent">
                <!-- Top bar: dark mode toggle + window controls -->
                <Grid VerticalAlignment="Top" Margin="16,14,14,0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    
                    <!-- Dark Mode Toggle â€” minimal icon button -->
                    <Button Width="34" Height="34"
                            Cursor="Hand"
                            ToolTip="Toggle Dark Mode">
                        <Button.Template>
                            <ControlTemplate TargetType="Button">
                                <Border x:Name="border"
                                        Background="#55FFFFFF"
                                        CornerRadius="17"
                                        Width="34" Height="34">
                                    <TextBlock x:Name="DarkModeIcon"
                                               Text="â˜€"
                                               FontSize="16"
                                               HorizontalAlignment="Center"
                                               VerticalAlignment="Center"
                                               Foreground="White"/>
                                </Border>
                                <ControlTemplate.Triggers>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter TargetName="border" Property="Background" Value="#77FFFFFF"/>
                                    </Trigger>
                                </ControlTemplate.Triggers>
                            </ControlTemplate>
                        </Button.Template>
                        <Button.Resources>
                            <Style TargetType="Border">
                                <EventSetter Event="MouseDown" Handler="DarkModeToggle_Click"/>
                            </Style>
                        </Button.Resources>
                    </Button>
                    
                    <!-- Window Controls -->
                    <StackPanel Grid.Column="2" Orientation="Horizontal">
                        <Button Content="âˆ’"
                                Width="28" Height="28"
                                FontSize="16"
                                Foreground="White"
                                BorderThickness="0"
                                Click="Minimize_Click"
                                Cursor="Hand"
                                ToolTip="Minimize">
                            <Button.Template>
                                <ControlTemplate TargetType="Button">
                                    <Border Background="#55000000" CornerRadius="14" x:Name="border">
                                        <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                    </Border>
                                    <ControlTemplate.Triggers>
                                        <Trigger Property="IsMouseOver" Value="True">
                                            <Setter TargetName="border" Property="Background" Value="#88000000"/>
                                        </Trigger>
                                    </ControlTemplate.Triggers>
                                </ControlTemplate>
                            </Button.Template>
                        </Button>
                        <Button Content="Ã—"
                                Width="28" Height="28"
                                FontSize="16"
                                Foreground="White"
                                BorderThickness="0"
                                Margin="6,0,0,0"
                                Click="Close_Click"
                                Cursor="Hand"
                                ToolTip="Close">
                            <Button.Template>
                                <ControlTemplate TargetType="Button">
                                    <Border Background="#55EF4444" CornerRadius="14" x:Name="border">
                                        <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                    </Border>
                                    <ControlTemplate.Triggers>
                                        <Trigger Property="IsMouseOver" Value="True">
                                            <Setter TargetName="border" Property="Background" Value="#BBEF4444"/>
                                        </Trigger>
                                    </ControlTemplate.Triggers>
                                </ControlTemplate>
                            </Button.Template>
                        </Button>
                    </StackPanel>
                </Grid>
                
                <!-- Centered Glass Card -->
                <Border x:Name="GlassCard"
                        VerticalAlignment="Center"
                        HorizontalAlignment="Center"
                        Width="340"
                        Background="#B3FFFFFF"
                        CornerRadius="24"
                        Padding="28,32,28,28"
                        Margin="0,50,0,0">
                    <Border.Effect>
                        <DropShadowEffect BlurRadius="40" ShadowDepth="6" Opacity="0.18" Color="#000000"/>
                    </Border.Effect>
                    
                    <StackPanel>
                        <!-- App Title -->
                        <TextBlock x:Name="AppTitle"
                                   Text="YouTube Downloader"
                                   FontSize="20"
                                   FontWeight="SemiBold"
                                   Foreground="#1A1A2E"
                                   HorizontalAlignment="Center"
                                   Margin="0,0,0,24"/>
                        
                        <!-- URL Input -->
                        <Border x:Name="SearchBorder"
                                Background="#CCFFFFFF"
                                CornerRadius="14"
                                Padding="14,11"
                                Margin="0,0,0,16">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <!-- Search icon via Path -->
                                <Viewbox Width="18" Height="18" Margin="0,0,10,0" VerticalAlignment="Center">
                                    <Canvas Width="24" Height="24">
                                        <Path Data="M15.5 14h-.79l-.28-.27A6.471 6.471 0 0 0 16 9.5 6.5 6.5 0 1 0 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zM9.5 14C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"
                                              Fill="#94A3B8"/>
                                    </Canvas>
                                </Viewbox>
                                <TextBox x:Name="UrlTextBox"
                                         Grid.Column="1"
                                         BorderThickness="0"
                                         Background="Transparent"
                                         VerticalAlignment="Center"
                                         FontSize="13"
                                         Text="Paste YouTube link hereâ€¦">
                                    <TextBox.Style>
                                        <Style TargetType="TextBox">
                                            <Setter Property="Foreground" Value="#94A3B8"/>
                                            <Setter Property="CaretBrush" Value="#1A1A2E"/>
                                            <EventSetter Event="GotFocus" Handler="UrlTextBox_GotFocus"/>
                                            <EventSetter Event="LostFocus" Handler="UrlTextBox_LostFocus"/>
                                        </Style>
                                    </TextBox.Style>
                                </TextBox>
                            </Grid>
                        </Border>
                        
                        <!-- Download Button -->
                        <Button Click="DownloadButton_Click"
                                HorizontalAlignment="Stretch"
                                Height="44"
                                Cursor="Hand"
                                BorderThickness="0"
                                Margin="0,0,0,20">
                            <Button.Template>
                                <ControlTemplate TargetType="Button">
                                    <Border x:Name="border" CornerRadius="12">
                                        <Border.Background>
                                            <LinearGradientBrush StartPoint="0,0" EndPoint="1,0.5">
                                                <GradientStop Color="#4F8CFF" Offset="0"/>
                                                <GradientStop Color="#3B6FE0" Offset="1"/>
                                            </LinearGradientBrush>
                                        </Border.Background>
                                        <Border.Effect>
                                            <DropShadowEffect BlurRadius="12" ShadowDepth="3" Opacity="0.2" Color="#3B6FE0"/>
                                        </Border.Effect>
                                        <StackPanel Orientation="Horizontal"
                                                    HorizontalAlignment="Center"
                                                    VerticalAlignment="Center">
                                            <!-- Down arrow icon -->
                                            <Viewbox Width="16" Height="16" Margin="0,0,8,0">
                                                <Canvas Width="24" Height="24">
                                                    <Path Data="M12 4 L12 16 M12 16 L7 11 M12 16 L17 11 M5 20 L19 20"
                                                          Stroke="White"
                                                          StrokeThickness="2.2"
                                                          StrokeEndLineCap="Round"
                                                          StrokeStartLineCap="Round"
                                                          StrokeLineJoin="Round"/>
                                                </Canvas>
                                            </Viewbox>
                                            <TextBlock Text="Download Video"
                                                       Foreground="White"
                                                       FontSize="15"
                                                       FontWeight="SemiBold"
                                                       VerticalAlignment="Center"/>
                                        </StackPanel>
                                    </Border>
                                    <ControlTemplate.Triggers>
                                        <Trigger Property="IsMouseOver" Value="True">
                                            <Setter TargetName="border" Property="Opacity" Value="0.9"/>
                                        </Trigger>
                                        <Trigger Property="IsPressed" Value="True">
                                            <Setter TargetName="border" Property="Opacity" Value="0.75"/>
                                        </Trigger>
                                    </ControlTemplate.Triggers>
                                </ControlTemplate>
                            </Button.Template>
                        </Button>
                        
                        <!-- Action Buttons Row -->
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="8"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            
                            <!-- Downloads Button -->
                            <Button Grid.Column="1"
                                    Width="120" Height="44"
                                    Click="ShowDownloads_Click"
                                    ToolTip="View Downloads"
                                    Cursor="Hand">
                                <Button.Template>
                                    <ControlTemplate TargetType="Button">
                                        <Border x:Name="border"
                                                Background="#BBFFFFFF"
                                                CornerRadius="12">
                                            <Viewbox Width="22" Height="22">
                                                <Canvas Width="24" Height="24">
                                                    <Path x:Name="DownloadIconPath1" Data="M12 3 L12 15 M12 15 L8 11 M12 15 L16 11"
                                                          Stroke="#475569"
                                                          StrokeThickness="2"
                                                          StrokeEndLineCap="Round"
                                                          StrokeStartLineCap="Round"
                                                          StrokeLineJoin="Round"/>
                                                    <Path x:Name="DownloadIconPath2" Data="M4 17 L4 19 C4 20.1 4.9 21 6 21 L18 21 C19.1 21 20 20.1 20 19 L20 17"
                                                          Stroke="#475569"
                                                          StrokeThickness="2"
                                                          StrokeEndLineCap="Round"
                                                          StrokeStartLineCap="Round"
                                                          StrokeLineJoin="Round"/>
                                                </Canvas>
                                            </Viewbox>
                                        </Border>
                                        <ControlTemplate.Triggers>
                                            <Trigger Property="IsMouseOver" Value="True">
                                                <Setter TargetName="border" Property="Background" Value="#1A000000"/>
                                            </Trigger>
                                        </ControlTemplate.Triggers>
                                    </ControlTemplate>
                                </Button.Template>
                            </Button>
                            
                            <!-- Folder Button -->
                            <Button Grid.Column="3"
                                    Width="120" Height="44"
                                    Click="OpenFolder_Click"
                                    ToolTip="Open Downloads Folder"
                                    Cursor="Hand">
                                <Button.Template>
                                    <ControlTemplate TargetType="Button">
                                        <Border x:Name="border"
                                                Background="#BBFFFFFF"
                                                CornerRadius="12">
                                            <Viewbox Width="22" Height="22">
                                                <Canvas Width="24" Height="24">
                                                    <Path x:Name="FolderIconPath" Data="M3 7 C3 5.9 3.9 5 5 5 L9 5 L11 7 L19 7 C20.1 7 21 7.9 21 9 L21 18 C21 19.1 20.1 20 19 20 L5 20 C3.9 20 3 19.1 3 18 Z"
                                                          Stroke="#475569"
                                                          StrokeThickness="2"
                                                          Fill="Transparent"
                                                          StrokeLineJoin="Round"/>
                                                </Canvas>
                                            </Viewbox>
                                        </Border>
                                        <ControlTemplate.Triggers>
                                            <Trigger Property="IsMouseOver" Value="True">
                                                <Setter TargetName="border" Property="Background" Value="#1A000000"/>
                                            </Trigger>
                                        </ControlTemplate.Triggers>
                                    </ControlTemplate>
                                </Button.Template>
                            </Button>
                        </Grid>
                    </StackPanel>
                </Border>
            </Grid>
            
            <!-- Downloads Panel (Hidden by default) -->
            <Border x:Name="DownloadsPanel" 
                    Background="{DynamicResource PanelBgBrush}"
                    CornerRadius="40"
                    RenderTransform="1,0,0,1,405,0"
                    ClipToBounds="True">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    
                    <!-- Downloads Header -->
                    <Border x:Name="DownloadsHeaderBorder" Grid.Row="0" Background="#F0F2F5" Padding="20,24,20,16">
                        <Border.Effect>
                            <DropShadowEffect BlurRadius="6" ShadowDepth="2" Opacity="0.08" Color="#000000" Direction="270"/>
                        </Border.Effect>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <Button x:Name="BackButton"
                                    Width="48" Height="48"
                                    Background="Transparent"
                                    BorderThickness="0"
                                    Click="HideDownloads_Click"
                                    Cursor="Hand"
                                    ToolTip="Back"
                                    Padding="10"
                                    VerticalAlignment="Center">
                                <Viewbox Width="24" Height="24">
                                    <Canvas Width="24" Height="24">
                                        <Path x:Name="BackArrowPath"
                                              Data="M15 4 L7 12 L15 20"
                                              Stroke="#94A3B8"
                                              StrokeThickness="2.8"
                                              StrokeEndLineCap="Round"
                                              StrokeStartLineCap="Round"
                                              StrokeLineJoin="Round"/>
                                    </Canvas>
                                </Viewbox>
                            </Button>
                            <TextBlock x:Name="DownloadsTitle" Grid.Column="1" 
                                       Text="Downloads" 
                                       FontSize="24" 
                                       FontWeight="SemiBold"
                                       Foreground="#1E293B"
                                       VerticalAlignment="Center"
                                       Margin="12,0,0,0"/>
                            <!-- Settings Button -->
                            <Button Grid.Column="2"
                                    Width="42"
                                    Height="42"
                                    Click="DownloadSettings_Click"
                                    Cursor="Hand"
                                    ToolTip="Download Settings">
                                <Button.Template>
                                    <ControlTemplate TargetType="Button">
                                        <Border x:Name="SettingsBorder" Background="#E2E8F0" 
                                                CornerRadius="12">
                                            <Viewbox Width="22" Height="22">
                                                <Canvas Width="24" Height="24">
                                                    <Path x:Name="SettingsGearIcon" Data="M12 8C9.79 8 8 9.79 8 12C8 14.21 9.79 16 12 16C14.21 16 16 14.21 16 12C16 9.79 14.21 8 12 8ZM12 14C10.9 14 10 13.1 10 12C10 10.9 10.9 10 12 10C13.1 10 14 10.9 14 12C14 13.1 13.1 14 12 14ZM19.43 12.98C19.47 12.66 19.5 12.34 19.5 12C19.5 11.66 19.47 11.34 19.43 11.02L21.54 9.37C21.73 9.22 21.78 8.95 21.66 8.73L19.66 5.27C19.54 5.05 19.27 4.97 19.05 5.05L16.56 6.05C16.04 5.65 15.48 5.32 14.87 5.07L14.49 2.42C14.46 2.18 14.25 2 14 2L10 2C9.75 2 9.54 2.18 9.51 2.42L9.13 5.07C8.52 5.32 7.96 5.66 7.44 6.05L4.95 5.05C4.72 4.96 4.46 5.05 4.34 5.27L2.34 8.73C2.21 8.95 2.27 9.22 2.46 9.37L4.57 11.02C4.53 11.34 4.5 11.67 4.5 12C4.5 12.33 4.53 12.66 4.57 12.98L2.46 14.63C2.27 14.78 2.22 15.05 2.34 15.27L4.34 18.73C4.46 18.95 4.73 19.03 4.95 18.95L7.44 17.95C7.96 18.35 8.52 18.68 9.13 18.93L9.51 21.58C9.54 21.82 9.75 22 10 22L14 22C14.25 22 14.46 21.82 14.49 21.58L14.87 18.93C15.48 18.68 16.04 18.34 16.56 17.95L19.05 18.95C19.28 19.04 19.54 18.95 19.66 18.73L21.66 15.27C21.78 15.05 21.73 14.78 21.54 14.63L19.43 12.98Z" 
                                                          Fill="#3B82F6"/>
                                                </Canvas>
                                            </Viewbox>
                                        </Border>
                                        <ControlTemplate.Triggers>
                                            <Trigger Property="IsMouseOver" Value="True">
                                                <Setter TargetName="SettingsBorder" Property="Background" Value="#CBD5E1"/>
                                            </Trigger>
                                            <Trigger Property="IsPressed" Value="True">
                                                <Setter TargetName="SettingsBorder" Property="Background" Value="#B0BCC9"/>
                                            </Trigger>
                                        </ControlTemplate.Triggers>
                                    </ControlTemplate>
                                </Button.Template>
                            </Button>
                        </Grid>
                    </Border>
                    
                    <!-- Tabs -->
                    <Border x:Name="TabsContainerBorder" Grid.Row="1" 
                            Background="#E8ECF1" 
                            CornerRadius="15" 
                            Margin="15,15,15,10"
                            Padding="4"
                            BorderBrush="#D1D5DB"
                            BorderThickness="1">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            
                            <!-- All Tab -->
                            <Border Background="Transparent" CornerRadius="12" Padding="8,8,8,4"
                                    MouseLeftButtonDown="AllTab_Click" Cursor="Hand">
                                <StackPanel HorizontalAlignment="Center">
                                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,0,0,6">
                                        <!-- Download-into-box icon -->
                                        <Viewbox Width="16" Height="16" Margin="0,0,6,0" VerticalAlignment="Center">
                                            <Canvas Width="24" Height="24">
                                                <Path x:Name="AllTabIcon" 
                                                      Data="M12 3 L12 15 M12 15 L8 11 M12 15 L16 11 M4 17 L4 19 C4 20.1 4.9 21 6 21 L18 21 C19.1 21 20 20.1 20 19 L20 17"
                                                      Stroke="#3B82F6"
                                                      StrokeThickness="2"
                                                      StrokeEndLineCap="Round"
                                                      StrokeStartLineCap="Round"
                                                      StrokeLineJoin="Round"/>
                                            </Canvas>
                                        </Viewbox>
                                        <TextBlock x:Name="AllTabText" Text="All" FontSize="15" FontWeight="SemiBold" 
                                                   Foreground="#3B82F6" VerticalAlignment="Center"/>
                                    </StackPanel>
                                    <Border x:Name="AllTabUnderline" Height="3" Background="#3B82F6" CornerRadius="1.5" 
                                            HorizontalAlignment="Stretch"/>
                                </StackPanel>
                            </Border>
                            
                            <!-- Downloaded Tab -->
                            <Border Grid.Column="1" Background="Transparent" CornerRadius="12" Padding="8,8,8,4"
                                    MouseLeftButtonDown="DownloadedTab_Click" Cursor="Hand">
                                <StackPanel HorizontalAlignment="Center">
                                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,0,0,6">
                                        <!-- Checkmark icon -->
                                        <Viewbox Width="16" Height="16" Margin="0,0,6,0" VerticalAlignment="Center">
                                            <Canvas Width="24" Height="24">
                                                <Path x:Name="DownloadedTabIcon"
                                                      Data="M5 13 L9 17 L19 7"
                                                      Stroke="#6B7280"
                                                      StrokeThickness="2.5"
                                                      StrokeEndLineCap="Round"
                                                      StrokeStartLineCap="Round"
                                                      StrokeLineJoin="Round"/>
                                            </Canvas>
                                        </Viewbox>
                                        <TextBlock x:Name="DownloadedTabText" Text="Downloaded" FontSize="15" FontWeight="SemiBold" 
                                                   Foreground="#6B7280" VerticalAlignment="Center"/>
                                    </StackPanel>
                                    <Border x:Name="DownloadedTabUnderline" Height="3" Background="Transparent" CornerRadius="1.5" 
                                            HorizontalAlignment="Stretch"/>
                                </StackPanel>
                            </Border>
                        </Grid>
                    </Border>
                    
                    <!-- Downloads List -->
                    <ScrollViewer Grid.Row="2" 
                                  VerticalScrollBarVisibility="Auto"
                                  Margin="15,0,15,0">
                        <StackPanel x:Name="DownloadsList">
                            <!-- Download items will be added here dynamically -->
                        </StackPanel>
                    </ScrollViewer>
                    
                    <!-- Bottom Actions -->
                    <Border Grid.Row="3" 
                            Background="#CCFFFFFF" 
                            BorderBrush="#80E2E8F0"
                            BorderThickness="0,1,0,0"
                            Padding="15">
                        <Button Content="ðŸ—‘ï¸ Clear List"
                                Background="Transparent"
                                Foreground="#3B82F6"
                                BorderBrush="#3B82F6"
                                BorderThickness="2"
                                Style="{StaticResource ModernButton}"
                                HorizontalAlignment="Stretch"
                                Click="ClearList_Click"/>
                    </Border>
                </Grid>
            </Border>
            

            <!-- Quality Selection Overlay (iOS Bottom Sheet Style) -->
            <!-- Quality Selection Overlay (iOS Bottom Sheet Style) -->
            <Border x:Name="QualityOverlay"
                    Background="#99000000"
                    Visibility="Collapsed"
                    MouseDown="QualityOverlay_MouseDown">
                <Grid>
                    <Border x:Name="QualityDialogBorder"
                            VerticalAlignment="Center"
                            HorizontalAlignment="Center"
                            Background="White"
                            CornerRadius="24"
                            Width="360"
                            MaxHeight="600"
                            Margin="20">
                        <Border.Effect>
                            <DropShadowEffect BlurRadius="30" ShadowDepth="8" Opacity="0.3"/>
                        </Border.Effect>
                        <Grid Margin="0">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/> <!-- Header -->
                                <RowDefinition Height="Auto"/> <!-- Video Info -->
                                <RowDefinition Height="Auto"/> <!-- Tabs -->
                                <RowDefinition Height="*"/>    <!-- List -->
                                <RowDefinition Height="Auto"/> <!-- Button -->
                            </Grid.RowDefinitions>
                            
                            <!-- Header -->
                            <Grid Grid.Row="0" Margin="20,20,20,10">
                                <TextBlock x:Name="QualityHeaderText"
                                          Text="Select Quality"
                                          FontSize="18"
                                          FontWeight="SemiBold"
                                          Foreground="#1A1A2E"
                                          HorizontalAlignment="Center"/>
                                <Button x:Name="QualityCloseButton"
                                       Content="âœ•"
                                       HorizontalAlignment="Right"
                                       Width="30"
                                       Height="30"
                                       FontSize="16"
                                       Background="Transparent"
                                       BorderThickness="0"
                                       Foreground="#666"
                                       Cursor="Hand"
                                       Click="CloseQualitySelector_Click"/>
                            </Grid>
                            
                            <!-- Video Info -->
                            <StackPanel Grid.Row="1" Margin="20,0,20,15">
                                <!-- Thumbnail with Duration -->
                                <Grid Height="140" Margin="0,0,0,12">
                                    <Border CornerRadius="12" ClipToBounds="True">
                                        <Image x:Name="QualityThumbnail" 
                                               Stretch="UniformToFill"/>
                                    </Border>
                                    <Border Background="#CC000000"
                                            CornerRadius="4"
                                            HorizontalAlignment="Left"
                                            VerticalAlignment="Bottom"
                                            Margin="8"
                                            Padding="6,2">
                                        <TextBlock x:Name="QualityDuration"
                                                   Text="12:04"
                                                   Foreground="White"
                                                   FontSize="12"
                                                   FontWeight="Medium"/>
                                    </Border>
                                </Grid>
                                
                                <TextBlock x:Name="QualityVideoTitle"
                                          Text="Video Title"
                                          FontSize="14"
                                          FontWeight="Medium"
                                          Foreground="#1F2937"
                                          TextWrapping="Wrap"
                                          MaxHeight="40"
                                          TextTrimming="CharacterEllipsis"
                                          Margin="0,0,0,4"/>
                                          
                                <TextBlock x:Name="QualityChannelInfo"
                                          Text="Channel â€¢ 12 min"
                                          FontSize="12"
                                          Foreground="#6B7280"
                                          TextTrimming="CharacterEllipsis"
                                          Margin="0,0,0,0"/>
                            </StackPanel>
                            
                            <!-- Custom Tab Selector -->
                            <Border x:Name="QualityTabContainer"
                                    Grid.Row="2" 
                                    Margin="20,0,20,15"
                                    Background="#F3F4F6"
                                    CornerRadius="8"
                                    Padding="2">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    
                                    <Button x:Name="VideoFormatTab"
                                            Content="ðŸ“¹ Video"
                                            Background="White"
                                            Foreground="#1F2937"
                                            BorderThickness="0"
                                            Height="32"
                                            FontSize="13"
                                            FontWeight="Medium"
                                            Click="VideoFormatTab_Click">
                                        <Button.Resources>
                                            <Style TargetType="Border">
                                                <Setter Property="CornerRadius" Value="6"/>
                                            </Style>
                                        </Button.Resources>
                                        <Button.Effect>
                                            <DropShadowEffect ShadowDepth="1" BlurRadius="2" Opacity="0.1"/>
                                        </Button.Effect>
                                    </Button>
                                    
                                    <Button x:Name="AudioFormatTab"
                                            Grid.Column="1"
                                            Content="ðŸŽµ Audio"
                                            Background="Transparent"
                                            Foreground="#6B7280"
                                            BorderThickness="0"
                                            Height="32"
                                            FontSize="13"
                                            FontWeight="Medium"
                                            Click="AudioFormatTab_Click"/>
                                </Grid>
                            </Border>
                            
                            <!-- Quality List -->
                            <ScrollViewer Grid.Row="3" 
                                        VerticalScrollBarVisibility="Auto"
                                        Margin="0,0,0,15"
                                        MaxHeight="200">
                                <StackPanel x:Name="QualityListPanel" Margin="20,0,20,0"/>
                            </ScrollViewer>
                            
                            <!-- Download Button -->
                            <Button Grid.Row="4"
                                   x:Name="QualityDownloadButton"
                                   Click="QualityDownload_Click"
                                   Height="44"
                                   Margin="20,0,20,20"
                                   Cursor="Hand"
                                   BorderThickness="0">
                                <Button.Template>
                                    <ControlTemplate TargetType="Button">
                                        <Border x:Name="border"
                                                CornerRadius="22"
                                                Background="#1A73E8">
                                            <TextBlock Text="Download"
                                                      Foreground="White"
                                                      FontSize="16"
                                                      FontWeight="SemiBold"
                                                      HorizontalAlignment="Center"
                                                      VerticalAlignment="Center"/>
                                        </Border>
                                        <ControlTemplate.Triggers>
                                            <Trigger Property="IsMouseOver" Value="True">
                                                <Setter TargetName="border" Property="Background" Value="#1557B0"/>
                                            </Trigger>
                                            <Trigger Property="IsPressed" Value="True">
                                                <Setter TargetName="border" Property="Background" Value="#0D47A1"/>
                                            </Trigger>
                                        </ControlTemplate.Triggers>
                                    </ControlTemplate>
                                </Button.Template>
                            </Button>
                        </Grid>
                    </Border>
                </Grid>
            </Border>
            
            <!-- Loading Overlay â€” Sakura Cherry Blossom Theme -->
            <Border x:Name="LoadingOverlay"
                    Visibility="Collapsed"
                    CornerRadius="40"
                    ClipToBounds="True">
                <Border.Background>
                    <SolidColorBrush x:Name="LoadingOverlayBg" Color="#88000000"/>
                </Border.Background>
                <Grid>
                    <!-- Animated petals canvas (inside the overlay) -->
                    <Canvas x:Name="LoadingPetalsCanvas" IsHitTestVisible="False"/>
                    
                    <Border x:Name="LoadingCard"
                            VerticalAlignment="Center"
                            HorizontalAlignment="Center"
                            Width="280"
                            CornerRadius="24"
                            Padding="28,32,28,28"
                            ClipToBounds="True">
                        <Border.Background>
                            <SolidColorBrush x:Name="LoadingCardBg" Color="#F4FFFAFB"/>
                        </Border.Background>
                        <Border.Effect>
                            <DropShadowEffect BlurRadius="30" ShadowDepth="6" Opacity="0.18" Color="#806060"/>
                        </Border.Effect>
                        <Grid>
                            <!-- Decorative petals in top-left corner -->
                            <Canvas IsHitTestVisible="False"
                                    VerticalAlignment="Top" HorizontalAlignment="Left"
                                    Margin="-10,-10,0,0" Opacity="0.08">
                                <Path Data="M12 2 C12 2 8 8 2 10 C8 10 12 14 12 20 C12 14 16 10 22 10 C16 8 12 2 12 2Z"
                                      Fill="#D4A0AA" Canvas.Left="0" Canvas.Top="5"
                                      RenderTransform="0.8,0,0,0.8,0,0"/>
                                <Path Data="M12 2 C12 2 8 8 2 10 C8 10 12 14 12 20 C12 14 16 10 22 10 C16 8 12 2 12 2Z"
                                      Fill="#CCAAB0" Canvas.Left="18" Canvas.Top="-2"
                                      RenderTransform="0.5,0,0,0.5,0,0"/>
                            </Canvas>
                            <!-- Decorative petals in bottom-right corner -->
                            <Canvas IsHitTestVisible="False" Opacity="0.06"
                                    VerticalAlignment="Bottom" HorizontalAlignment="Right"
                                    Margin="0,0,-8,-8">
                                <Path Data="M12 2 C12 2 8 8 2 10 C8 10 12 14 12 20 C12 14 16 10 22 10 C16 8 12 2 12 2Z"
                                      Fill="#D4A0AA" Canvas.Left="-20" Canvas.Top="-15"
                                      RenderTransform="0.7,0,0,0.7,0,0"/>
                            </Canvas>
                            
                            <StackPanel HorizontalAlignment="Center">
                                <!-- Sakura spinning ring -->
                                <Grid Width="56" Height="56" Margin="0,0,0,18"
                                      HorizontalAlignment="Center">
                                    <!-- Background ring track -->
                                    <Ellipse Width="56" Height="56"
                                             StrokeThickness="4"
                                             x:Name="LoadingRingBg">
                                        <Ellipse.Stroke>
                                            <SolidColorBrush Color="#F0E0E4"/>
                                        </Ellipse.Stroke>
                                    </Ellipse>
                                    <!-- Spinning sakura gradient ring -->
                                    <Ellipse Width="56" Height="56"
                                             StrokeThickness="4"
                                             x:Name="LoadingRingFg"
                                             RenderTransformOrigin="0.5,0.5"
                                             StrokeDashArray="2.5 4"
                                             StrokeDashCap="Round">
                                        <Ellipse.Stroke>
                                            <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                                <GradientStop Color="#E8A0B0" Offset="0"/>
                                                <GradientStop Color="#D4889A" Offset="0.5"/>
                                                <GradientStop Color="#C0707E" Offset="1"/>
                                            </LinearGradientBrush>
                                        </Ellipse.Stroke>
                                        <Ellipse.RenderTransform>
                                            <RotateTransform x:Name="LoadingSpinnerRotation" Angle="0"/>
                                        </Ellipse.RenderTransform>
                                    </Ellipse>
                                    <!-- Cherry blossom icon in center -->
                                    <TextBlock Text="ðŸŒ¸" FontSize="20"
                                               HorizontalAlignment="Center"
                                               VerticalAlignment="Center"
                                               x:Name="LoadingCenterIcon"/>
                                </Grid>
                                <!-- Loading message -->
                                <TextBlock x:Name="LoadingMessageText"
                                           Text="Fetching video informationâ€¦"
                                           FontSize="14"
                                           FontWeight="Medium"
                                           HorizontalAlignment="Center"
                                           TextAlignment="Center">
                                    <TextBlock.Foreground>
                                        <SolidColorBrush x:Name="LoadingTextFg" Color="#3D2B35"/>
                                    </TextBlock.Foreground>
                                </TextBlock>
                                <!-- Subtle hint -->
                                <TextBlock Text="This may take a moment"
                                           FontSize="11"
                                           HorizontalAlignment="Center"
                                           Margin="0,6,0,0"
                                           x:Name="LoadingSubText">
                                    <TextBlock.Foreground>
                                        <SolidColorBrush Color="#B0959E"/>
                                    </TextBlock.Foreground>
                                </TextBlock>
                            </StackPanel>
                        </Grid>
                    </Border>
                </Grid>
            </Border>
        </Grid>
    </Border>
</Window>
